# 视频缩略图功能说明

## 功能概述

本功能为视频作品自动生成缩略图，提取视频第一帧作为作品展示的封面图片。

## 技术实现

### 后端实现

1. **依赖包**: 使用 `fluent-ffmpeg` 处理视频文件
2. **工具模块**: `utils/videoProcessor.js` 提供视频处理功能
3. **存储位置**: 缩略图存储在 `uploads/thumbnails/` 目录
4. **文件命名**: `{原文件名}_thumbnail.jpg`

### 前端展示

1. **Gallery页面**: 优先显示缩略图，如果没有缩略图则显示占位符
2. **WorkDetail页面**: 支持缩略图显示

## 使用方法

### 上传视频作品

1. 用户上传视频文件
2. 系统自动检测文件类型为视频
3. 后端自动生成缩略图（提取第1秒的帧）
4. 缩略图路径保存到数据库的 `thumbnail` 字段

### 查看作品

1. 在作品展示页面，视频作品会显示生成的缩略图
2. 如果缩略图生成失败，会显示"视频缩略图生成中..."占位符

## 配置说明

### 缩略图设置

- **尺寸**: 640x360 像素
- **格式**: JPEG
- **截取时间**: 视频第1秒
- **质量**: 默认质量

### 系统要求

- 服务器需要安装 FFmpeg
- Node.js 环境
- 足够的磁盘空间存储缩略图

## 错误处理

1. 如果FFmpeg未安装或配置错误，缩略图生成会失败但不影响作品上传
2. 生成失败的视频作品会显示默认占位符
3. 错误信息会记录在服务器日志中

## 注意事项

1. 缩略图生成是异步过程，可能需要几秒钟时间
2. 视频文件越大，处理时间越长
3. 建议定期清理无用的缩略图文件
4. 删除作品时，相关的缩略图文件也会被删除

## 故障排除

### 缩略图无法生成

1. 检查FFmpeg是否正确安装
2. 检查视频文件格式是否支持
3. 检查磁盘空间是否充足
4. 查看服务器错误日志

### 缩略图显示异常

1. 检查文件路径是否正确
2. 检查文件权限设置
3. 检查网络连接

## 未来改进

1. 支持自定义截取时间点
2. 支持多种缩略图尺寸
3. 支持批量重新生成缩略图
4. 支持缩略图压缩优化